{
  "NDM_metadata": {
    "authority": "com.chinamobile",
    "OF_protocol_version": "1.3.4",
    "type": "TTPv1.0",
    "name": "MPLS-TP SPTN Switch",
    "version": "0.8",
    "doc": [
      "Datapath model for an MPLS-TP SPTN switch.",
      "Reference: MPLS-TP OpenFlow Extensions for SPTN: ONF TS-029"
    ]
  },
  "features": [
    {
      "feature": "EXT-230",
      "doc": [
        "Bundles (ONF Extensions Pack 1), use optional"
      ]
    },
    {
      "feature": "EXT-232",
      "doc": [
        "Table Synchronization (ONF Extensions Pack 1)"
      ]
    },
    {
      "feature": "EXT-233",
      "doc": [
        "Output Port Metadata (ONF Extensions Pack 2)"
      ]
    },
    {
      "feature": "EXT-244",
      "doc": [
        "Packet Registers (ONF Extensions Pack 2), Introduces PKT_REG(N) field."
      ]
    },
    {
      "feature": "EXT-320",
      "doc": [
        "Copy Field (ONF Extensions Pack 2)"
      ]
    },
    {
      "feature": "EXT-262",
      "doc": [
        "All messages should be TLV for ease of extensibility",
        "Added port description properties",
        "Requires OpenFlow 1.4."
      ]
    },
    {
      "feature": "EXT-306",
      "doc": [
        "Egress Tables",
        "Defined in OpenFlow 1.5",
        "Can be used with 1.3.4 except for table features message extensions."
      ]
    },
    {
      "feature": "ALLOW_IN_PORT",
      "doc": [
        "Used in group entries to override default OpenFlow IN_PORT forwarding restrictions.",
        "See EXT-138"
      ]
    }
  ],
  "table_map": [
    {
      "name": "Ingress Port",
      "number": 0
    },
    {
      "name": "Injected OAM",
      "number": 9
    },
    {
      "name": "VLAN",
      "number": 10
    },
    {
      "name": "Ingress Maintenance Point",
      "number": 12
    },
    {
      "name": "MPLS L2 Port",
      "number": 13
    },
    {
      "name": "MPLS L2 Port DSCP Trust",
      "number": 15
    },
    {
      "name": "MPLS L2 Port PCP Trust",
      "number": 16
    },
    {
      "name": "MPLS L2 Port QoS Class",
      "number": 17
    },
    {
      "name": "L2 Policer",
      "number": 18
    },
    {
      "name": "L2 Policer Actions",
      "number": 19
    },
    {
      "name": "Termination MAC",
      "number": 20
    },
    {
      "name": "MPLS 0",
      "number": 23
    },
    {
      "name": "MPLS 1",
      "number": 24
    },
    {
      "name": "MPLS 2",
      "number": 25
    },
    {
      "name": "MPLS-TP Maintenance Point",
      "number": 26
    },
    {
      "name": "MPLS Label Trust",
      "number": 28
    },
    {
      "name": "MPLS Type",
      "number": 29
    },
    {
      "name": "Policy ACL",
      "number": 60
    },
    {
      "name": "Egress VLAN",
      "number": 210
    },
    {
      "name": "Egress Maintenance Point",
      "number": 226
    },
    {
      "name": "Egress DSCP PCP Remark",
      "number": 230
    },
    {
      "name": "Egress TPID",
      "number": 235
    }
  ],
  "identifiers": [
    {
      "var": "<pport_no>",
      "doc": [
        "ifNum, 32-bit value. Physical ports in range 1..65535 (0x0000nnnn)."
      ]
    },
    {
      "var": "<lport_no>",
      "doc": [
        "ifNum, 32-bit value. Logical ports > 65536"
      ]
    },
    {
      "var": "<port_no>",
      "doc": [
        "ifNum, any port"
      ]
    },
    {
      "var": "<vid>",
      "range": "1..4095",
      "doc": [
        "12-bit VLAN id value from header field.",
        "OpenFlow sets bit 12 to indicate presence of the field."
      ]
    },
    {
      "var": "<port_vid>",
      "range": "1..4095",
      "doc": [
        "Port VLAN id used for VLAN assignment.",
        "OpenFlow sets bit 12 to indicate presence of the field."
      ]
    },
    {
      "var": "<mpls_tunnel_id>",
      "range": "2**16..2**17-1",
      "doc": [
        "Different ranges for different tunnel types.",
        "Non-tunnel packets from physical ports always have tunnel_id zero."
      ]
    },
    {
      "var": "<eth_type>",
      "doc": [
        "Any valid ethertype, which will be  >1536 (0x0600),",
        "except for 0x8870 (jumbo frame)"
      ]
    },
    {
      "var": "<pcp>",
      "range": "0..7",
      "doc": [
        "VLAN header PCP field"
      ]
    },
    {
      "var": "<dei>",
      "range": "0..1",
      "doc": [
        "VLAN header DEI field"
      ]
    },
    {
      "var": "<qos_index>",
      "range": "0..255",
      "doc": [
        "index into a QoS table"
      ]
    },
    {
      "var": "<openFlowMpId>",
      "range": "1..(2**32-1)",
      "doc": [
        "Lmep id provides connection between OpenFlow and OF-Config domains."
      ]
    },
    {
      "var": "<provider_mp_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate provider mdl when more than one openFlowMpId is mentioned in the actions."
      ]
    },
    {
      "var": "<mip_mp_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate mip (customer mdl) when more than one openFlowMpId is mentioned in the actions."
      ]
    },
    {
      "var": "<pw_mp_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate layer when more than one openFlowMpId is mentioned in the actions."
      ]
    },
    {
      "var": "<lsp_mp_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate layer when more than one openFlowMpId is mentioned in the actions."
      ]
    },
    {
      "var": "<section_mp_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate layer when more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<interface_mp_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate interface mdlwhen more than one openFlowMpId is mentioned in the actions."
      ]
    },
    {
      "var": "<mdl>",
      "range": "0..7",
      "doc": [
        "Y.1731 OAM frame maintenance level."
      ]
    },
    {
      "var": "<mpls_l2_port>",
      "doc": [
        "Virtual ingress port for MPLS packets."
      ]
    },
    {
      "var": "<local_mpls_l2_port>",
      "range": "0..65535",
      "doc": [
        "Virtual ingress port for MPLS packets.",
        "Indicates packet from UNI (high 16 bits are 0x0000)."
      ]
    },
    {
      "var": "<network_mpls_l2_port>",
      "range": "131072..196607",
      "doc": [
        "Virtual ingress port for MPLS packets.",
        "Indicates packet from NNI (high 16 bits are 0x0002)."
      ]
    },
    {
      "var": "<mac>",
      "doc": [
        "A MAC address"
      ]
    },
    {
      "var": "<local_mac>",
      "doc": [
        "Unicast MAC address of router."
      ]
    },
    {
      "var": "<meter_index>",
      "range": "1..65535 (0x0000nnnn)",
      "doc": [
        "Index into meter table."
      ]
    },
    {
      "var": "<l2_policer_meter_index>",
      "range": ">65535",
      "doc": [
        "Index into meter table.",
        "Greater than 0xffff."
      ]
    },
    {
      "var": "<color_actions_index>",
      "doc": [
        "Index into a color actions table.",
        "Pipeline metadata."
      ]
    },
    {
      "var": "<ipv4_addr>",
      "doc": [
        "IPv4 Address - 32 bits represented as 4 decimal values - nnn.nnn.nnn.nnn"
      ]
    },
    {
      "var": "<ipv6_addr>",
      "doc": [
        "IPv6 Address - 128 bits represented as 8 groups of hex quartets - nnnn:nnnn:nnnn:nnnn:nnnn:nnnn:nnnn:nnnn"
      ]
    },
    {
      "var": "<ip_proto>",
      "range": "0..255",
      "doc": [
        "IP Header Protocol field."
      ]
    },
    {
      "var": "<ip_dscp>",
      "range": "0..64",
      "doc": [
        "IP Header DSCP field."
      ]
    },
    {
      "var": "<ip_ecn>",
      "range": "0..7",
      "doc": [
        "IP Header ECN field."
      ]
    },
    {
      "var": "<icmp_type>",
      "range": "0..255",
      "doc": [
        "ICMP Header Type field value."
      ]
    },
    {
      "var": "<icmp_code>",
      "range": "0..255",
      "doc": [
        "ICMP Header Code field value."
      ]
    },
    {
      "var": "<l4_port>",
      "range": "1..65535",
      "doc": [
        "16-bit TCP, UDP, or SCTP port number"
      ]
    },
    {
      "var": "<mpls_label>",
      "range": "1..1048575",
      "doc": [
        "20-bit label - reserved values should be excluded"
      ]
    },
    {
      "var": "<mpls_tc>",
      "range": "0..7",
      "doc": [
        "3-bit MPLS header TC field."
      ]
    },
    {
      "var": "<mpls_type>",
      "range": "1..2**15",
      "doc": [
        "1: VPWS; Others Reserved."
      ]
    },
    {
      "var": "<counter_id>",
      "range": "0..2**32-1",
      "doc": [
        "Counter id for class and color based counters."
      ]
    },
    {
      "var": "<opcode>",
      "range": "0..255",
      "doc": [
        "Y.1731 header opcode field."
      ]
    },
    {
      "var": "<traffic_class>",
      "range": "0..7",
      "doc": [
        "A TRAFFIC_CLASS value."
      ]
    },
    {
      "var": "<<group_entry_types:name>>",
      "doc": [
        "Group Entry Identifier (see Name Format in Group Entry Types)"
      ]
    },
    {
      "id": "PUSH_L2_HEADER",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 1,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "POP_L2_HEADER",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 2,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "PUSH_CW",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 3,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "POP_CW_OR_ACH",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 4,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "COPY_MPLS_TC_IN",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 5,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "COPY_MPLS_TC_OUT",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 6,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "OAM_LM_TX_COUNT",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 10,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Increments MEP loss measurement Tx counter using current Traffic_Class value.",
        "Requires openFlowMpId argument with value <mp_id> to identify the counters for the MEP."
      ]
    },
    {
      "id": "OAM_LM_RX_COUNT",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 11,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Increments MEP loss measurement Rx counter using current Traffic_Class value",
        "Requires openFlowMpId argument with value <mp_id> to identify the counters for the MEP."
      ]
    },
    {
      "id": "OAM_SET_COUNTER_FIELDS",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 12,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Harvests loss measurement counters for a MEP by priority.",
        "Requires openFlowMpId argument with value <mp_id> to identify counters for the MEP.",
        "Priority is taken from the OAM LMR message."
      ]
    },
    {
      "id": "DEC_TTL_MTU",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 13,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "CHECK_DROP_STATUS",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 14,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Requires type and index arguments.",
        "For LCK drop use type 0 and openFlowMpId index."
      ]
    },
    {
      "id": "SET_MPLS_TC_FROM_VPN_TABLE",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 7,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Sets MPLS_TC in PW shim header using current Traffic_Class and Color values",
        "Invoked from an MPLS VPN group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "SET_MPLS_PCP_DEI_FROM_VPN_TABLE",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 16,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Sets outer VLAN PCP for a PW using current Traffic_Class and Color values.",
        "Invoked from an MPLS VPN group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "SET_MPLS_TC_FROM_TUNNEL_TABLE",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 17,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Sets MPLS_TC field in LSP shim header using current Traffic_Class and Color values.",
        "Invoked from an MPLS Tunnel group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "SET_MPLS_PCP_DEI_FROM_TUNNEL_TABLE",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 18,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Sets outer VLAN PCP for an LSP using current Traffic_Class and Color values",
        "Invoked from an MPLS Tunnel group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "CLASS_BASED_COUNT",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 19,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Increments referenced Tx packet and byte counters for the current value of Traffic_Class.",
        "Requires index argument with value <index> to identify a set of counters."
      ]
    },
    {
      "id": "COLOR_BASED_COUNT",
      "type": "action",
      "exp_id": "0xFF00000A",
      "exp_code": 20,
      "doc": [
        "Action Identifier defined in SPTN OpenFlow Extensions.",
        "Increments referenced Tx packet and byte counters for the current value of Color.",
        "Requires index argument with value <index> to identify a set of counters."
      ]
    },
    {
      "id": "COPY_TC",
      "type": "action",
      "exp_id": "0x4F4E4600",
      "exp_code": 3200,
      "doc": [
        "Programmed using the OpenFlow action defined in EXT-320.",
        "The Copy-Field action copies src_oxm_id[src_offset:src_offset+n_bits] to ",
        "dst_oxm_id[dst_offset:dst_offset+n_bits],",
        "where a[b:c] denotes the bits within  a  numbered  b  through  c  (not including bit  c ).",
        "Bit numbering starts at 0 for the least-significant bit, 1 for the next most significant bit, and so on.",
        "TTP v1.0 does not provide a general way to accommodate extensions like COPY_FIELD. To accommodate using, ",
        "this extension, the operation name is used to encode the number of bits, the \"value\" argument provides the src OXM,",
        " and the \"field\" argument provides the dst OXM.",
        "For example, COPY_TC is used to copy 3 bits with src and dst offset 0,",
        " and would be represented using the EXT-320 with num_bits 3.",
        "The dst field is zero extended to the left if larger than the src OXM, and truncated if smaller."
      ]
    },
    {
      "id": "COPY_VID",
      "type": "action",
      "exp_id": "0x4F4E4600",
      "exp_code": 3200,
      "doc": [
        "Similar COPY_TC except used to copy 12 bits of VLAN ID.",
        "Refer to COPY_TC for description, except num_bits is 12."
      ]
    },
    {
      "id": "TRAFFIC_CLASS",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 2,
      "doc": [
        "Pipeline metadata field representing QoS traffic class.",
        "Eight values supported: BE(0), AF1(1), AF2(2), AF3(3), AF4(4), EF(5), CS6(6), CS7(7)"
      ]
    },
    {
      "id": "COLOR",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 3,
      "doc": [
        "Pipeline metadata field representing drop precedence.",
        "Three values supported: Green(0), Yellow(1), Red(2)"
      ]
    },
    {
      "id": "VLAN_DEI",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 4,
      "doc": [
        "Ethernet header field for Drop Eligibility Indication.",
        "Defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "QOS_INDEX",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 5,
      "doc": [
        "Pipeline metadata field providing an index into one of the QoS tables."
      ]
    },
    {
      "id": "openFlowMpId",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 6,
      "doc": [
        "Pipeline metadata field used to tag packet context with the OAM processing engine."
      ]
    },
    {
      "id": "MPLS_TTL",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 7,
      "doc": [
        "MPLS shim header field for TTL.",
        "Defined in SPTN OpenFlow Extensions."
      ]
    },
    {
      "id": "MPLS_L2_PORT",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 8,
      "doc": [
        "Pipeline metadata field representing a packet logical ingress point."
      ]
    },
    {
      "id": "OVID",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 10,
      "doc": [
        "Pipeline metadata field used to hold the outermost VLAN tag for subsequent matching."
      ]
    },
    {
      "id": "MPLS_DATA_FIRST_NIBBLE",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 11,
      "doc": [
        "MPLS protocol stack header field, first 4 bits following the MPLS bottom of stack label."
      ]
    },
    {
      "id": "MPLS_ACH_CHANNEL",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 12,
      "doc": [
        "MPLS header field used for OAM.",
        "Defined in ITU G.8113.1/Y.1732 OAM Specifications."
      ]
    },
    {
      "id": "NEXT_LABEL_IS_GAL",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 13,
      "doc": [
        "Pipeline metadata field set by the switch parser to help identify the OAM frame type."
      ]
    },
    {
      "id": "OAM_Y1731_MDL",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 14,
      "doc": [
        "Ethernet OAM header field defined in ITU G.8013/Y.1731.",
        "Indicates maintenance level."
      ]
    },
    {
      "id": "OAM_Y1731_OPCODE",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 15,
      "doc": [
        "Ethernet OAM header field defined in ITU G.8013/Y.1731.",
        "Indicates OAM message type."
      ]
    },
    {
      "id": "COLOR_ACTIONS_INDEX",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 16,
      "doc": [
        "Pipeline metadata field defined in SPTN OpenFlow Extensions.",
        "Matched in color based action tables to select entry by drop precedence."
      ]
    },
    {
      "id": "TXFCL",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 17,
      "doc": [
        "Pipeline Field Identifier defined in SPTN OpenFlow Extensions.",
        "Represents harvested loss measurement Tx counter value."
      ]
    },
    {
      "id": "RXFCL",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 18,
      "doc": [
        "Pipeline Field Identifier defined in SPTN OpenFlow Extensions.",
        "Represents harvested loss measurement Rx counter value."
      ]
    },
    {
      "id": "RX_TIMESTAMP",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 19,
      "doc": [
        "Pipeline Field Identifier defined in SPTN OpenFlow Extensions.",
        "Represents timestamp when performance measurement message received."
      ]
    },
    {
      "id": "PROTECTION_INDEX",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 21,
      "doc": [
        "Pipeline Field used to identify whether a label is for the working or protection path."
      ]
    },
    {
      "id": "ACTSET_OUTPUT",
      "type": "field",
      "exp_id": "0x4F4E4600",
      "exp_code": 43,
      "doc": [
        "Pipeline Field that identifies the output port in an egress table, defined in EXT-233."
      ]
    },
    {
      "id": "MPLS_TYPE",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 23,
      "doc": [
        "Pipeline metadata field defined in SPTN OpenFlow Extensions.",
        "Bit mask. Indicates flow type, one of: None(0), VPLS(1), OAM(4)."
      ]
    },
    {
      "id": "ALLOW_VLAN_TRANSLATION",
      "type": "field",
      "exp_id": "0xFF00000A",
      "exp_code": 24,
      "doc": [
        "Pipeline metadata field indicating egress VLAN id is not filtered and can be modified."
      ]
    }
  ],
  "flow_tables": [
    {
      "name": "Ingress Port",
      "doc": [
        "First table in pipeline.",
        "Normal Ethernet packets processed by VLAN table.",
        "Injected OAM frames processed by Injected OAM table."
      ],
      "flow_mod_types": [],
      "built_in_flow_mods": [
        {
          "name": "Normal Ethernet",
          "priority": "2",
          "doc": [
            "Subscriber frame.",
            "Fixed, cannot be modified or deleted."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        },
        {
          "name": "OAM PDU Injection",
          "priority": "1",
          "doc": [
            "Treat as OAM PDU by default.",
            "Fixed, cannot be modified or deleted."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Injected OAM"
            }
          ]
        }
      ]
    },
    {
      "name": "Injected OAM",
      "doc": [
        "Injected OAM frames are Y.1731 Ethernet.",
        "MPLS-TP OAM frames output encapsulated and forwarded."
      ],
      "flow_mod_types": [
        {
          "name": "Ethernet Service Up MEP or MHF (Proactive OAM)",
          "priority": "2",
          "doc": [
            "Inject into MPLS tunnel pipeline before forwarding and conditioning.",
            "Used when need to count proactive PDUs at current level",
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "exact"
            },
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_VID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<local_mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Ethernet Service Up MEP or MHF",
          "priority": "1",
          "doc": [
            "Inject into MPLS tunnel pipeline before forwarding and conditioning.",
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_VID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<local_mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Ethernet Service Down MEP or MHF",
          "priority": "1",
          "doc": [
            "Inject into UNI egress pipeline after conditioning.",
            "Count in Egress Maintenance Point if LM enabled.",
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_VID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section (Proactive OAM)",
          "priority": "2",
          "doc": [
            "Send to next hop.",
            "Used when need to count proactive PDUs at current level",
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "exact"
            },
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section",
          "priority": "1",
          "doc": [
            "Send to next hop.",
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "LSP MEP or MIP (Proactive OAM)",
          "priority": "2",
          "doc": [
            "openFlowMpid, traffic class and color metadata with packet.",
            "Used when need to count proactive PDUs at current level"
          ],
          "match_set": [
            {
              "field": "$ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "exact"
            },
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "13"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Interface>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<lsp_mep_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "LSP MEP or MIP",
          "priority": "1",
          "doc": [
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "13"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Interface>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV Type 1 or 3 (Proactive OAM)",
          "priority": "2",
          "doc": [
            "openFlowMpid, traffic class and color metadata with packet.",
            "Used when need to count proactive PDUs at current level"
          ],
          "match_set": [
            {
              "field": "$ETH_TYPE",
              "value": "0x8902",
              "match_type": "all_or_exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Tunnel Label 1>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<pw_mep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV Type 1 or 3",
          "priority": "1",
          "doc": [
            "openFlowMpid, traffic class and color metadata with packet."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Tunnel Label 1>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV Type 4 (Proactive OAM)",
          "priority": "2",
          "doc": [
            "Used when need to count proactive PDUs at current level",
            "openFlowMpid,, traffic class and color metadata with packet.",
            "Push GAL then label."
          ],
          "match_set": [
            {
              "field": "$ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "exact"
            },
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Tunnel Label 1>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<pw_mep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV Type 4",
          "priority": "1",
          "doc": [
            "openFlowMpid, traffic class and color metadata with packet.",
            "Push GAL then label."
          ],
          "match_set": [
            {
              "field": "$openFlowMpId",
              "value": "<mp_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Tunnel Label 1>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Drop.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "VLAN",
      "doc": [
        "Ingress VLAN Assignment and Translation.",
        "If Ethernet Service MIP configured send frame to Ingress Maintenance Point.",
        "Process two tags by assigning metadata, pop, go to VLAN 1 to process inner tag."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Filtering (NNI)",
          "priority": "3",
          "doc": [
            "Matches outer VLAN ID."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            }
          ]
        },
        {
          "name": "VLAN Assignment - Untagged  (Port VLAN Assignment - NNI)",
          "priority": "3",
          "doc": [
            "Port VLAN for untagged.",
            "Pushes a VLAN tag with TPID 0x8100.",
            "Sets outer VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_VID",
                  "value": "<port_vid>"
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Assignment -  Priority Tagged (Port VLAN Assignment - NNI)",
          "priority": "3",
          "doc": [
            "Port VLAN for priority tagged. Sets outer VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_VID",
                  "value": "<vid>"
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Allow All Tagged (NNI)",
          "priority": "7",
          "doc": [
            "Turns off VLAN filtering.",
            "Only applies to tagged packets regardless of  VLAN"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            }
          ]
        },
        {
          "name": "MPLS L2 Single Tag (UNI)",
          "priority": "6",
          "doc": [
            "MPLS match criteria - single tagged VLAN.",
            "A port cannot have conflicting VLAN match and all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured. "
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_VID",
                      "value": "<vid>"
                    },
                    {
                      "action": "POP_VLAN"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<local_mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_COUNT",
                      "field": "<counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Untagged (UNI)",
          "priority": "5",
          "doc": [
            "MPLS Match criteria untagged packet. Pushes and sets outer VLAN.",
            "A port cannot have conflicting untagged VLAN match and all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured. "
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_VID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<local_mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_COUNT",
                      "field": "<counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2  Priority Tagged (UNI)",
          "priority": "5",
          "doc": [
            "MPLS Match criteria priority tagged. Sets outer VLAN.",
            "A port cannot have conflicting untagged VLAN match and all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured. "
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_VID",
                      "value": "<vid>"
                    },
                    {
                      "action": "POP_VLAN"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<local_mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_COUNT",
                      "field": "<counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 All Traffic on Port (UNI)",
          "priority": "6",
          "doc": [
            "MPLS - all traffic on port (VLAN match omitted, highest priority). ",
            "A port cannot have conflicting VLAN match and  all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<local_mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_COUNT",
                      "field": "<counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop rule, no VLAN for frame.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "Ingress Maintenance Point",
      "doc": [
        "Process packets for Ethernet Service OAM MIP or MEP from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "Down MHF LBM Process (Client MDL)",
          "priority": "5",
          "doc": [
            "Configure MIP (LTM to local MAC) at this MDL."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "3",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST",
              "value": "<local_mac>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "Down MHF LTM Process (Client MDL)",
          "priority": "4",
          "doc": [
            "Configure MIP (LTR, destination MAC is Class 2 Multicast) at this MDL."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "5",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Process (our MDL)",
          "priority": "5",
          "doc": [
            "interface Down MEP.",
            "Process all PDUs at specified MDL. PDU can be either Provider or Interface level.",
            "Provider LM counts Interface PDUs."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<interface_mp_id>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Passthru - higher MDL",
          "priority": "3",
          "doc": [
            "Must be programmed to pass higher MDL PDUs for this user and treat as data.",
            "MDL higher than provider, check for LCK and provider Tx count.",
            "MDL higher than interface (generally level 0) interface Rx count.",
            "Without these entries PDUs may be dropped unnecessarily."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS",
                      "field": "<provider_mp_id>",
                      "value": 0
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Drop (lower MDL)",
          "priority": "2",
          "doc": [
            "Must be programmed to enable active filtering of lower MDL than provider -",
            "(interface PDUs already processed in higher priority rule).",
            "The optional output is so OAM engine can generate drop notification."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MEP Data",
          "priority": "1",
          "doc": [
            "For provider MEP optionally check for LCK and Tx Count.",
            "For interface MEP optionally Rx count."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS",
                      "field": "<provider_mp_id>",
                      "value": 0
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Not sure what to do with this packet, supposed to be a MIP or MEP here.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port",
      "doc": [
        "Represents ingress port for MPLS service flow from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS v4 DSCP",
          "priority": "4",
          "doc": [
            "Fowarding decision required for VPWS.",
            "IPv4 DSCP simple classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS v6 DSCP",
          "priority": "4",
          "doc": [
            "Fowarding decision required for VPWS.",
            "IPv6 DSCP simple classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS PCP",
          "priority": "3",
          "doc": [
            "Fowarding decision required for VPWS.",
            "PCP simple classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS",
          "priority": "2",
          "doc": [
            "Fowarding decision required for VPWS.",
            "No QoS trust classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port QoS Class"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default, skip simple classification.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port DSCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port QoS Class"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port QoS Class"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to MPLS QoS Classifier Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port QoS Class"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port PCP Trust",
      "doc": [
        "Classify traffic class and color based on VLAN PCP field."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS-TP Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            },
            {
              "field": "VLAN _PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port QoS Class"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to MPLS QoS Classifier Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port QoS Class"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port QoS Class",
      "doc": [
        "Classify traffic class and color based on complicated policies."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS-TP IPv4 MAC IP",
          "priority": "3",
          "doc": [
            "MAC, IPv4 and L4 combinations"
          ],
          "match_set": [
            {
              "field": "$MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "IPV4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPV4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS-TP IPv6 IP",
          "priority": "2",
          "doc": [
            "IPv6 addresses only"
          ],
          "match_set": [
            {
              "field": "$MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS-TP IPv4 IP",
          "priority": "2",
          "doc": [
            "IPv4 and L4 combinations (more efficient matching)"
          ],
          "match_set": [
            {
              "field": "$MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "IPV4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPV4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS-TP MAC",
          "priority": "1",
          "doc": [
            "MAC addresses only (more efficient matching)"
          ],
          "match_set": [
            {
              "field": "$MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default is to pass packet on.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            }
          ]
        }
      ]
    },
    {
      "name": "Termination MAC",
      "doc": [
        "Determine whether to bridge, route, or MPLS process a packet.",
        "Bridge packet if MAC destination is other than local.",
        "If local MAC then use ETH-TYPE to decide how to process."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS",
          "priority": "2",
          "doc": [
            "MPLS termination."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS 0"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS 1"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss is to drop packet.",
            "Fixed rule. Cannot be  modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 0",
      "doc": [
        "Match outermost MPLS label.",
        "Used for three label processing scenarios.",
        "Miss continues to MPLS 1."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label (no MEP)",
          "priority": "1",
          "doc": [
            "LSP terminate, ring or divert label.  No MEP on label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (MEP Data)",
          "priority": "1",
          "doc": [
            "LSP terminate, ring or divert label. Label has MEP with LM"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<lsp_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (MEP Control)",
          "priority": "2",
          "doc": [
            "LSP terminate ring or divert label. Label has MEP, OAM Control PDU",
            "Pop GAL label and make packet look like an Ethernet OAM frame",
            "Higher priority than non-OAM rule for this label, which must be installed first."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<lsp_mp_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Built-in default on miss.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 1",
      "doc": [
        "First MPLS match table. Matches outermost MPLS shim header.",
        "Contains superset of flow entries in MPLS 2",
        "Updating MPLS 1 updates applicable flow entries in MPLS 2.",
        "Flow entries that go to MPLS 2 are not synchronized."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label",
          "priority": "1",
          "doc": [
            "LSP termination. Action on next label.",
            "This label does not have a MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on this label (PHP)",
          "priority": "1",
          "doc": [
            "LSP termination. PHP so no maintenance point."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label and forward based on this label",
          "priority": "1",
          "doc": [
            "LSP Swap. This label does not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label and forward based on this label",
          "priority": "1",
          "doc": [
            "PW Swap, like LSP swap but BOS. Used for MS-PW.",
            "This label doess not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP MEP Data)",
          "priority": "1",
          "doc": [
            "LSP termination. Action on next label.",
            "This label has a MEP with LM enabled and this is a data frame.",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<lsp_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP MEP Control)",
          "priority": "2",
          "doc": [
            "LSP termination but  MEP on label and OAM PDU.",
            "Pop GAL and make packet look like an Ethernet OAM frame.",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<lsp_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label (LSP OAM MIP Control)",
          "priority": "2",
          "doc": [
            "LSP swap with MIP on label and OAM PDU. No LM/DM on MIP.",
            "Pop GAL and make packet look like an Ethernet OAM frame",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label (MS-PW OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop PW label and make packet look like an Ethernet OAM frame."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch  (PW Terminate)",
          "priority": "1",
          "doc": [
            "PW Terminate.",
            "Group needs to be supplied if MPLS_TYPE is VPWS.",
            "Optional actions if MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_VLAN"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<networkl_mpls_l2_port>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<pw_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 4 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "OAM enabled, next label is GAL.",
            "Pop PW and GAL, make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule for a label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<pw_mp_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 1 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<pw_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 3 (OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MIP control packet.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<pw_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section OAM",
          "priority": "5",
          "doc": [
            "Section OAM - Match GAL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "13",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<section_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "PW OAM Unexpected Control (default rule)",
          "priority": "0",
          "doc": [
            "PW Unexpected OAM (ACH control frame) - Drop",
            "This event should be a notification",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 2",
      "doc": [
        "Second MPLS match table. Matches outermost label after pop.",
        "Applicable flow entries updated with MPLS 1.",
        "Flow entries that go to MPLS 2 are not applicable."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on this label (PHP)",
          "priority": "1",
          "doc": [
            "LSP termination. PHP so no maintenance point."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label and forward based on this label",
          "priority": "1",
          "doc": [
            "LSP Swap. This label does not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label and forward based on this label",
          "priority": "1",
          "doc": [
            "PW Swap, like LSP swap but BOS. Used for MS-PW.",
            "This label doess not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label (LSP OAM MIP Control)",
          "priority": "2",
          "doc": [
            "LSP swap with MIP on label and OAM PDU. No LM/DM on MIP.",
            "Pop GAL and make packet look like an Ethernet OAM frame",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<lsp_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<section_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<section_mp_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label (MS-PW OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop PW label and make packet look like an Ethernet OAM frame."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch  (PW Terminate)",
          "priority": "1",
          "doc": [
            "PW Terminate.",
            "Group needs to be supplied if MPLS_TYPE is VPWS.",
            "Optional actions if MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_TC",
                          "field": "$PKT_REG(0)",
                          "value": "MPLS_TC"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<networkl_mpls_l2_port>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<pw_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 4 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "OAM enabled, next label is GAL.",
            "Pop PW and GAL, make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule for a label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<pw_mp_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 1 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<pw_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 3 (OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MIP control packet.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<pw_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_COUNT",
                      "field": "<pw_counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section OAM",
          "priority": "5",
          "doc": [
            "Section OAM - Match GAL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "13",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<section_mp_id>"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "PW OAM Unexpected Control (default rule)",
          "priority": "0",
          "doc": [
            "PW Unexpected OAM (ACH control frame) - Drop",
            "This event should be a notification",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Label Trust",
      "doc": [
        "Classify traffic class and color based on MPLS_TC field."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS-TP Trust",
          "priority": "1",
          "doc": [
            "Set Traffic Class and Color."
          ],
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "$PKT_REG(0)",
              "value": "<mpls_tc>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default pass through.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Type",
      "doc": [
        "Goto table based on MPLS type pipeline field."
      ],
      "flow_mod_types": [],
      "built_in_flow_mods": [
        {
          "name": "VPWS",
          "priority": "1",
          "doc": [
            "MPLS-TP VPWS, go to Policy ACL Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "$MPLS_TYPE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss, drop packet.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS-TP Maintenance Point",
      "doc": [
        "Process OAM frame for G.8113.1 Down MEP or MIP."
      ],
      "flow_mod_types": [
        {
          "name": "MEP PDU Process",
          "priority": "3",
          "doc": [
            "ETH-TYPE is to satisfy OpenFlow prerequisite."
          ],
          "match_set": [
            {
              "field": "LMEP ID",
              "value": "<mp_id>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "$OAM_SET_COUNTER_FIELDS",
                  "field": "<mp_id>",
                  "value": "<traffic_class>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default rule, built in. ",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Policer",
      "doc": [
        "Per-service meters applied to Ethernet Service frames from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS_L2_Port  Meter",
          "priority": "2",
          "doc": [
            "Must be a UNI-NNI flow (MPLS_L2_Port is local).",
            "Meter index must be greater than 0xffff."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "<l2_policer_meter_index>"
            },
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "L2 Policer Actions"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": "<index>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Policer Actions",
      "doc": [
        "Actions based on packet color.",
        "Must be separate from L2 Policer table."
      ],
      "flow_mod_types": [
        {
          "name": "Green Actions",
          "priority": "2",
          "doc": [
            "Green Rule."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Yellow Actions",
          "priority": "2",
          "doc": [
            "Yellow Rule."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Red Actions",
          "priority": "2",
          "doc": [
            "Red Rule."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "2",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": " Default",
          "priority": "0",
          "doc": [
            "Built-in rule, no action on a miss, but clear color actions index.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            }
          ]
        }
      ]
    },
    {
      "name": "Policy ACL",
      "doc": [
        "Match on variety of fields.",
        "Can redirect, drop, meter, copy-to-CONTROLLER, etc."
      ],
      "flow_mod_types": [
        {
          "name": "IPv6 VLAN",
          "priority": "4",
          "doc": [
            "IPv6 - switched/bridged packet including terminated MPLS"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_FLABEL",
              "value": "<ipv6_flabel>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS L2 VPN Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Swap Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Fast Failover>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic_class>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 MPLS-TP",
          "priority": "4",
          "doc": [
            "IPv6 - switched/bridged packet for initiated MPLS"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_FLABEL",
              "value": "<ipv6_flabel>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS L2 VPN Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Swap Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Fast Failover>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic_class>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 VLAN",
          "priority": "2",
          "doc": [
            "IPv4 - switched/bridged packet including terminated MPLS"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ARP_SPA",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS L2 VPN Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Swap Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Fast Failover>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic_class>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 MPLS-TP",
          "priority": "2",
          "doc": [
            "IPv4 - switched/bridged packet for initiated MPLS"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ARP_SPA",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS L2 VPN Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Swap Label>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<MPLS Fast Failover>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic_class>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Process the action set.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    },
    {
      "name": "Egress VLAN",
      "doc": [
        "Used for Egress VLAN Translation.",
        "If Ethernet Service OAM MIP or Up MEP then send frame to Egress Maintenance Point."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Translate, optional MIP and/or MEP",
          "priority": "2",
          "doc": [
            "Final packet can be single tagged or double tagged.",
            "If MIP and/or MEP go to Egress Maintenance Point,",
            "otherwise OUTPUT packet."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress Maintenance Point"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress DSCP PCP Remark"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_VID",
                      "value": "<vid>"
                    },
                    {
                      "action": "POP_VLAN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_VID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_COUNT",
                      "field": "<counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MIP and/or MEP",
          "priority": "1",
          "doc": [
            "MIP and/or MEP, go to Egress Maintenance Point"
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": "0",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress Maintenance Point"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_COUNT",
                      "field": "<counter_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Continue to next table on miss.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress DSCP PCP Remark"
            }
          ]
        }
      ]
    },
    {
      "name": "Egress Maintenance Point",
      "doc": [
        "Process OAM frame for MIP or Up MEP.",
        "Data frames may be counted and forwarded."
      ],
      "flow_mod_types": [
        {
          "name": "Up MHF PDU Process (LBM)",
          "priority": "5",
          "doc": [
            "Ethernet Service MIP (LBM).",
            "openFlowMpId is of MIP",
            "Drop and send to LOCAL engine.",
            "Could be up to seven levels in theory."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "3",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST",
              "value": "<local_mac>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "Up MHF PDU Process (our LTM)",
          "priority": "5",
          "doc": [
            "Ethernet Service MIP (LTM).",
            "openFlowMpId is of MIP",
            "Drop and send to LOCAL engine.",
            "Could be up to seven levels in theory."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "5",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST",
              "value": "01-80-c2-00-00-38",
              "match_type": "mask",
              "mask": "ff-ff-ff-ff-ff-ff-f8"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<mip_mp_id>"
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Process (our MDL)",
          "priority": "4",
          "doc": [
            "Process all PDUs at Provider MDL.",
            "openFlowMpId is of Provider MEP",
            "Drop and send to LOCAL engine."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$openFlowMpId",
                  "value": "<provider_mp_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_SET_COUNTER_FIELDS",
                      "field": "<provider_mp_id>",
                      "value": "<traffic_class>"
                    }
                  ]
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Passthrough (higher MDL)",
          "priority": "3",
          "doc": [
            "For Ethernet OAM packets must  be programmed to pass through higher MDL.",
            "Packet forwarded to original OUTPUT port.",
            "openFlowMpId is of Provider MEP in LCK and LM counter.",
            "Could be up to seven levels in theory."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS",
                      "field": "<interface_mp_id>",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Drop (lower MDL)",
          "priority": "2",
          "doc": [
            "Must be programmed for active filtering. Applies to both MIP and MEP.",
            "Can selectively notify by message, usually just for CCM.",
            "Drop and send to LOCAL engine for optional notification."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Data Passthough (Provider Up MEP Rx from partner and/or CFM Down MEP TX to partner)",
          "priority": "1",
          "doc": [
            "Override default rule for Provider MEP(s).",
            "openFlowMpId is for Provider or CFM MEP(s).",
            "Could be up to seven levels in theory.",
            "Provider Up MEP Rx from partner and/or CFM Down MEP TX to partner"
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress DSCP PCP Remark"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT",
                      "field": "<provider_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT",
                      "field": "<interface_mp_id>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS",
                      "field": "<interface_mp_id>",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "There's suppposed to be a MEP or MIP here.",
            "But don't know what to do with this packet, so just forward it.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress DSCP PCP Remark"
            }
          ]
        }
      ]
    },
    {
      "name": "Egress DSCP PCP Remark",
      "doc": [
        "Used for optionally marking QoS fields in VLAN and IP headers.",
        "Marking based on final TRAFFIC_CLASS and COLOR values."
      ],
      "flow_mod_types": [
        {
          "name": "Remark PCP DSCP (IPv 4)",
          "priority": "2",
          "doc": [
            "Remark DSCP (IPv4), PCP, and/or DEI.",
            "Can be used to set S-Tag PCP and DEI for UNI-UNI interoperability.",
            "Ethertype required as prerequisite."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$TRAFFIC_CLASS",
              "value": "<traffic_class>",
              "match_type": "exact"
            },
            {
              "field": "$COLOR",
              "value": "<color>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Remark PCP DSCP (IPv6)",
          "priority": "2",
          "doc": [
            "Remark DSCP (IPv6), PCP, and/or DEI.",
            "Can be used to set S-Tag PCP and DEI for UNI-UNI interoperability.",
            "Ethertype required as prerequisite."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$TRAFFIC_CLASS",
              "value": "<traffic_class>",
              "match_type": "exact"
            },
            {
              "field": "$COLOR",
              "value": "<color>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Remark PCP",
          "priority": "1",
          "doc": [
            "Remark VLAN PCP, and/or DEI.",
            "Can be used to set S-Tag PCP and DEI for UNI-UNI interoperability."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$TRAFFIC_CLASS",
              "value": "<traffic_class>",
              "match_type": "exact"
            },
            {
              "field": "$COLOR",
              "value": "<color>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Do not change QoS header field values.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            }
          ]
        }
      ]
    },
    {
      "name": "Egress TPID",
      "doc": [
        "Used to set the outermost TPID (VLAN tag Ethertype) on tagged packets."
      ],
      "flow_mod_types": [
        {
          "name": "S-Tag",
          "priority": "2",
          "doc": [
            "Make NNI port - set TPID to S-TAG (0x88a8).",
            "Last table in egress pipeline.",
            "Packet must have a VLAN tag."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "COPY_VID",
                  "field": "$PKT_REG(1)",
                  "value": "VLAN_VID"
                },
                {
                  "action": "POP_VLAN"
                },
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x88a8"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_VID",
                  "value": "$PKT_REG(1)"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss tagged",
          "priority": "1",
          "doc": [
            "Default is UNI port - set TPID to C-TAG (0x8100).",
            "Last table in egress pipeline.",
            "Only applies to packets with a VLAN tag.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "COPY_VID",
                  "field": "$PKT_REG(1)",
                  "value": "VLAN_VID"
                },
                {
                  "action": "POP_VLAN"
                },
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_VID",
                  "value": "$PKT_REG(1)"
                }
              ]
            }
          ]
        },
        {
          "name": "Table miss untagged",
          "priority": "0",
          "doc": [
            "Default untagged - send out port.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    }
  ],
  "group_entry_types": [
    {
      "name": "MPLS L2 VPN Label",
      "doc": [
        "VLAN id and L2 Addresses are set in MPLS Interface group",
        "Drop stats checks for LCK condition.",
        "LM counters used for  PW OAM, Traffic Class supplied by switch",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:1, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "$CHECK_DROP_STATUS",
                  "field": "<mp_id>",
                  "value": 0
                }
              ]
            },
            {
              "action": "$PUSH_L2_HEADER"
            },
            {
              "zero_or_one": [
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                }
              ]
            },
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "$PUSH_CW"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_BOS",
              "value": "1"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCP_DEI_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_COUNT",
                  "field": "<counter_id>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT",
                  "field": "$openFlowMpId"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Swap Label Group",
      "doc": [
        "LM count used for MPLS-TP LSP or PW",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:5, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "$CHECK_DROP_STATUS",
                  "field": "<mp_id>",
                  "value": 0
                }
              ]
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCP_DEI_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_COUNT",
                  "field": "<counter_id>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT",
                  "field": "$LMEP_ID"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Tunnel Label 1",
      "doc": [
        "Used for MPLS LSP.",
        "LM count used for G.8113.1 LSP only.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:3, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "$CHECK_DROP_STATUS",
                  "field": "<mp_id>",
                  "value": 0
                }
              ]
            },
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCP_DEI_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "COPY_TTL_OUT"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_COUNT",
                  "field": "<counter_id>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT",
                  "field": "$openFlowMpId"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Tunnel label 2",
      "doc": [
        "Used to push a third label for certain flows (e.g., ring label).",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:4, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "action": "$CHECK_DROP_STATUS",
              "field": "<mp_id>",
              "value": 0
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCP_DEI_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "COPY_TTL_OUT"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_COUNT",
                  "field": "<counter_id>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT",
                  "field": "<mp_id>"
                }
              ]
            },
            {
              "action": "GROUP",
              "group_id": "<MPLS Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Fast Failover",
      "doc": [
        "Working (1) or protection (0) path bucket. ",
        "Next Label depends on specifics of packet flow. ",
        "Watch OAM Protection Liveness Logical Port.",
        "Both buckets must chain to the same group entry type.",
        "Naming Convention: Type [31:28]:10, Sub-Type [27:24]:6, Index{23:0]:0xnnnnnn"
      ],
      "group_type": "FF",
      "bucket_types": [
        {
          "name": "Working(1)",
          "doc": [
            "watch : <lport_no>"
          ],
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        },
        {
          "name": "Protection(0) ",
          "doc": [
            "watch : <lport_no>"
          ],
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Interface",
      "doc": [
        "Used to OUTPUT an MPLS encapsulated packet",
        "LM Count used for Section OAM, Traffic Class supplied by switch.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:0"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC",
              "value": "<mac>"
            },
            {
              "action": "SET_FIELD",
              "field": "MAC_DST",
              "value": "<mac>"
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_VID",
              "value": "<vid>"
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT",
                  "field": "<section_mp_id>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Tag",
      "doc": [
        "TPIDs are the ones allowed in the OpenFlow Spec.",
        "May have other constraints on TPID.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:10, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "SD-TagActions",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "all": [
                    {
                      "action": "PUSH_VLAN",
                      "ethertype": "<ethertype>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_VID",
                      "value": "<vid>"
                    }
                  ]
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Interface",
      "doc": [
        "Port VLAN filtering enabled, this VLAN allowed.",
        "Implementations can  use to configure egress port VLAN.",
        "VLAN cannot be changed after this group entry.",
        "Naming Convention : Type [31:28]:0, Vlan Id [27:16]:0xnnn, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "VlanTagging",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "POP_VLAN"
                }
              ]
            },
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            },
            {
              "action": "SET_FIELD",
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": 0
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Unfiltered Interface",
      "doc": [
        "Port has egress VLAN filtering disabled, any VLAN allowed.",
        "Allow Egress VLAN Translation to change outermost VLAN.",
        "Naming Convention : Type [31:28]:11, Vlan Id [27:16]:0x000, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "AllowAllVLANs",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": 1
            },
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            }
          ]
        }
      ]
    }
  ],
  "meter_table": {
    "meter_types": [
      {
        "name": "Color Set Experimenter Meter Type",
        "doc": [
          "RFC Standard policer",
          "color is one of: green(0), yellow(1), red(2)",
          "color_aware is one of: Color Blind(0), Color Aware(1)",
          "mode is one of: TrTCM(1), SrTCM(2), Modified TrTCM(4)"
        ],
        "bands": [
          {
            "doc": [
              "color: <color>",
              "color_aware: <color-aware>",
              "mode: <mode>"
            ],
            "rate": "<meter_rate>",
            "burst": "<meter_burst>"
          }
        ]
      }
    ]
  }
}
